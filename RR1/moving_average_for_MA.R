#rm(list=ls())

# бібліотека для прогнозування
library(fpp2)
library(forecast)
library(png)
library(grid)

# зчитування файла з даними
pharma <- read.csv("C:/Users/Sophia/Documents/MO_Rozraha1/Rozrahunkova1/farm_sales_f.csv", header = TRUE)

#M01AB
M01AB_desk <- ts(pharma[,2], start = c(2016,1), frequency = 300)
M01AB_3 = forecast::ma(M01AB_desk, order = 3, centre = TRUE)
M01AB_5 = forecast::ma(M01AB_desk, order = 5, centre = TRUE)
M01AB_7 = forecast::ma(M01AB_desk, order = 7, centre = TRUE)

M01AB_3_3 = forecast::ma(M01AB_3, order = 3, centre = TRUE)
M01AB_3_5 = forecast::ma(M01AB_3, order = 5, centre = TRUE)
M01AB_3_7 = forecast::ma(M01AB_3, order = 7, centre = TRUE)
M01AB_3_9 = forecast::ma(M01AB_3, order = 9, centre = TRUE)
M01AB_3_11 = forecast::ma(M01AB_3, order = 11, centre = TRUE)
M01AB_3_13 = forecast::ma(M01AB_3, order = 13, centre = TRUE)
M01AB_3_15 = forecast::ma(M01AB_3, order = 15, centre = TRUE)

M01AB_5_3 = forecast::ma(M01AB_5, order = 3, centre = TRUE)
M01AB_5_5 = forecast::ma(M01AB_5, order = 5, centre = TRUE)
M01AB_5_7 = forecast::ma(M01AB_5, order = 7, centre = TRUE)
M01AB_5_9 = forecast::ma(M01AB_5, order = 9, centre = TRUE)
M01AB_5_11 = forecast::ma(M01AB_5, order = 11, centre = TRUE)
M01AB_5_13 = forecast::ma(M01AB_5, order = 13, centre = TRUE)
M01AB_5_15 = forecast::ma(M01AB_5, order = 15, centre = TRUE)

M01AB_7_3 = forecast::ma(M01AB_7, order = 3, centre = TRUE)
M01AB_7_5 = forecast::ma(M01AB_7, order = 5, centre = TRUE)
M01AB_7_7 = forecast::ma(M01AB_7, order = 7, centre = TRUE)
M01AB_7_9 = forecast::ma(M01AB_7, order = 9, centre = TRUE)
M01AB_7_11 = forecast::ma(M01AB_7, order = 11, centre = TRUE)
M01AB_7_13 = forecast::ma(M01AB_7, order = 13, centre = TRUE)
M01AB_7_15 = forecast::ma(M01AB_7, order = 15, centre = TRUE)

pdf(file="C:/Users/Sophia/Documents/MO_Rozraha1/Rozrahunkova1/plots/Mov_Av_2/M01AB_movingaverage2.pdf",
    width = 4,
    height = 4)
plot_M01AB3 <- plot(M01AB_desk, xlab = "Years, interval 3 (3)", ylab = "Sales volumes M01AB")
lines(M01AB_3_3, col="blue", lwd=3)
plot_M01AB5 <- plot(M01AB_desk, xlab = "Years, interval 5 (3)", ylab = "Sales volumes M01AB")
lines(M01AB_3_5, col="yellow", lwd=3)
plot_M01AB7 <- plot(M01AB_desk, xlab = "Years, interval 7 (3)", ylab = "Sales volumes M01AB")
lines(M01AB_3_7, col="green", lwd=3)
plot_M01AB9 <- plot(M01AB_desk, xlab = "Years, interval 9 (3)", ylab = "Sales volumes M01AB")
lines(M01AB_3_9, col="purple", lwd=3)
plot_M01AB11 <- plot(M01AB_desk, xlab = "Years, interval 11 (3)", ylab = "Sales volumes M01AB")
lines(M01AB_3_11, col="pink", lwd=3)
plot_M01AB13 <- plot(M01AB_desk, xlab = "Years, interval 13 (3)", ylab = "Sales volumes M01AB")
lines(M01AB_3_13, col="grey", lwd=3)
plot_M01AB15 <- plot(M01AB_desk, xlab = "Years, interval 15 (3)", ylab = "Sales volumes M01AB")
lines(M01AB_3_15, col="red", lwd=3)
abline(v=0)
text(x = 0, y = 1, labels="M01AB_ma")
plot_M01AB3 <- plot(M01AB_desk, xlab = "Years, interval 3 (5)", ylab = "Sales volumes M01AB")
lines(M01AB_5_3, col="blue", lwd=3)
plot_M01AB5 <- plot(M01AB_desk, xlab = "Years, interval 5 (5)", ylab = "Sales volumes M01AB")
lines(M01AB_5_5, col="yellow", lwd=3)
plot_M01AB7 <- plot(M01AB_desk, xlab = "Years, interval 7 (5)", ylab = "Sales volumes M01AB")
lines(M01AB_5_7, col="green", lwd=3)
plot_M01AB9 <- plot(M01AB_desk, xlab = "Years, interval 9 (5)", ylab = "Sales volumes M01AB")
lines(M01AB_5_9, col="purple", lwd=3)
plot_M01AB11 <- plot(M01AB_desk, xlab = "Years, interval 11 (5)", ylab = "Sales volumes M01AB")
lines(M01AB_5_11, col="pink", lwd=3)
plot_M01AB13 <- plot(M01AB_desk, xlab = "Years, interval 13 (5)", ylab = "Sales volumes M01AB")
lines(M01AB_5_13, col="grey", lwd=3)
plot_M01AB15 <- plot(M01AB_desk, xlab = "Years, interval 15 (5)", ylab = "Sales volumes M01AB")
lines(M01AB_5_15, col="red", lwd=3)
abline(v=0)
text(x = 0, y = 1, labels="M01AB_ma")

plot_M01AB3 <- plot(M01AB_desk, xlab = "Years, interval 3 (7)", ylab = "Sales volumes M01AB")
lines(M01AB_7_3, col="blue", lwd=3)
plot_M01AB5 <- plot(M01AB_desk, xlab = "Years, interval 5 (7)", ylab = "Sales volumes M01AB")
lines(M01AB_7_5, col="yellow", lwd=3)
plot_M01AB7 <- plot(M01AB_desk, xlab = "Years, interval 7 (7)", ylab = "Sales volumes M01AB")
lines(M01AB_7_7, col="green", lwd=3)
plot_M01AB9 <- plot(M01AB_desk, xlab = "Years, interval 9 (7)", ylab = "Sales volumes M01AB")
lines(M01AB_7_9, col="purple", lwd=3)
plot_M01AB11 <- plot(M01AB_desk, xlab = "Years, interval 11 (7)", ylab = "Sales volumes M01AB")
lines(M01AB_7_11, col="pink", lwd=3)
plot_M01AB13 <- plot(M01AB_desk, xlab = "Years, interval 13 (7)", ylab = "Sales volumes M01AB")
lines(M01AB_7_13, col="grey", lwd=3)
plot_M01AB15 <- plot(M01AB_desk, xlab = "Years, interval 15 (7)", ylab = "Sales volumes M01AB")
lines(M01AB_7_15, col="red", lwd=3)
abline(v=0)
text(x = 0, y = 1, labels="M01AB_ma")
dev.off()
