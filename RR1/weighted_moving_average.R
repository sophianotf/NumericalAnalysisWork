#rm(list=ls())

# бібліотека для прогнозування
library(fpp2)
library(forecast)
library(png)
library(grid)
library(zoo)
library(TTR)
require(graphics)
# зчитування файла з даними
pharma <- read.csv("C:/Users/Sophia/Documents/MO_Rozraha1/Rozrahunkova1/farm_sales_f.csv", header = TRUE)

#M01AB
M01AB_desk <- ts(pharma[,2], start = c(2016,1))
M01AB_3 = WMA(M01AB_desk, 3, 1:3)
M01AB_5 = WMA(M01AB_desk, 5, 1:5)
M01AB_7 = WMA(M01AB_desk, 7, 1:7)
M01AB_9 = WMA(M01AB_desk, 9, 1:9)
M01AB_11 = WMA(M01AB_desk, 11, 1:11)
M01AB_13 = WMA(M01AB_desk, 13, 1:13)
M01AB_15 = WMA(M01AB_desk, 15, 1:15)
pdf(file="C:/Users/Sophia/Documents/MO_Rozraha1/Rozrahunkova1/plots/Weighted/M01AB_WMA.pdf",
    width = 4,
    height = 4)
plot_M01AB <- plot(M01AB_desk, xlab = "Years, interval 3", ylab = "Sales volumes M01AB")
lines(M01AB_3, col="blue", lwd=3)
plot_M01AB <- plot(M01AB_desk, xlab = "Years, interval 5", ylab = "Sales volumes M01AB")
lines(M01AB_5, col="yellow", lwd=3)
plot_M01AB <- plot(M01AB_desk, xlab = "Years, interval 7", ylab = "Sales volumes M01AB")
lines(M01AB_7, col="green", lwd=3)
plot_M01AB9 <- plot(M01AB_desk, xlab = "Years, interval 9", ylab = "Sales volumes M01AB")
lines(M01AB_9, col="purple", lwd=3)
plot_M01AB11 <- plot(M01AB_desk, xlab = "Years, interval 11", ylab = "Sales volumes M01AB")
lines(M01AB_11, col="pink", lwd=3)
plot_M01AB13 <- plot(M01AB_desk, xlab = "Years, interval 13", ylab = "Sales volumes M01AB")
lines(M01AB_13, col="grey", lwd=3)
plot_M01AB15 <- plot(M01AB_desk, xlab = "Years, interval 15", ylab = "Sales volumes M01AB")
lines(M01AB_15, col="red", lwd=3)
abline(v=0)
text(x = 0, y = 1, labels="M01AB_wma")
dev.off()

#M01AE
M01AE_desk <- ts(pharma[,3], start = c(2016,1))
M01AE_3 = WMA(M01AE_desk, 3, 1:3)
M01AE_5 = WMA(M01AE_desk, 5, 1:5)
M01AE_7 = WMA(M01AE_desk, 7, 1:7)
M01AE_9 = WMA(M01AE_desk, 9, 1:9)
M01AE_11 = WMA(M01AE_desk, 11, 1:11)
M01AE_13 = WMA(M01AE_desk, 13, 1:13)
M01AE_15 = WMA(M01AE_desk, 15, 1:15)
pdf(file="C:/Users/Sophia/Documents/MO_Rozraha1/Rozrahunkova1/plots/Weighted/M01AE_WMA.pdf",
    width = 4,
    height = 4)
plot_M01AE <- plot(M01AE_desk, xlab = "Years, interval 3", ylab = "Sales volumes M01AE")
lines(M01AE_3, col="blue", lwd=3)
plot_M01AE <- plot(M01AE_desk, xlab = "Years, interval 5", ylab = "Sales volumes M01AE")
lines(M01AE_5, col="yellow", lwd=3)
plot_M01AE <- plot(M01AE_desk, xlab = "Years, interval 7", ylab = "Sales volumes M01AE")
lines(M01AE_7, col="green", lwd=3)
plot_M01AE9 <- plot(M01AE_desk, xlab = "Years, interval 9", ylab = "Sales volumes M01AE")
lines(M01AE_9, col="purple", lwd=3)
plot_M01AE11 <- plot(M01AE_desk, xlab = "Years, interval 11", ylab = "Sales volumes M01AE")
lines(M01AE_11, col="pink", lwd=3)
plot_M01AE13 <- plot(M01AE_desk, xlab = "Years, interval 13", ylab = "Sales volumes M01AE")
lines(M01AE_13, col="grey", lwd=3)
plot_M01AE15 <- plot(M01AE_desk, xlab = "Years, interval 15", ylab = "Sales volumes M01AE")
lines(M01AE_15, col="red", lwd=3)
abline(v=0)
text(x = 0, y = 1, labels="M01AE_wma")
dev.off()

#N02BA
N02BA_desk <- ts(pharma[,4], start = c(2016,1))
N02BA_3 = WMA(N02BA_desk, 3, 1:3)
N02BA_5 = WMA(N02BA_desk, 5, 1:5)
N02BA_7 = WMA(N02BA_desk, 7, 1:7)
N02BA_9 = WMA(N02BA_desk, 9, 1:9)
N02BA_11 = WMA(N02BA_desk, 11, 1:11)
N02BA_13 = WMA(N02BA_desk, 13, 1:13)
N02BA_15 = WMA(N02BA_desk, 15, 1:15)
pdf(file="C:/Users/Sophia/Documents/MO_Rozraha1/Rozrahunkova1/plots/Weighted/N02BA_WMA.pdf",
    width = 4,
    height = 4)
plot_N02BA <- plot(N02BA_desk, xlab = "Years, interval 3", ylab = "Sales volumes N02BA")
lines(N02BA_3, col="blue", lwd=3)
plot_N02BA <- plot(N02BA_desk, xlab = "Years, interval 5", ylab = "Sales volumes N02BA")
lines(N02BA_5, col="yellow", lwd=3)
plot_N02BA <- plot(N02BA_desk, xlab = "Years, interval 7", ylab = "Sales volumes N02BA")
lines(N02BA_7, col="green", lwd=3)
plot_N02BA9 <- plot(N02BA_desk, xlab = "Years, interval 9", ylab = "Sales volumes N02BA")
lines(N02BA_9, col="purple", lwd=3)
plot_N02BA11 <- plot(N02BA_desk, xlab = "Years, interval 11", ylab = "Sales volumes N02BA")
lines(N02BA_11, col="pink", lwd=3)
plot_N02BA13 <- plot(N02BA_desk, xlab = "Years, interval 13", ylab = "Sales volumes N02BA")
lines(N02BA_13, col="grey", lwd=3)
plot_N02BA15 <- plot(N02BA_desk, xlab = "Years, interval 15", ylab = "Sales volumes N02BA")
lines(N02BA_15, col="red", lwd=3)
abline(v=0)
text(x = 0, y = 1, labels="N02BA_wma")
dev.off()

#N02BE
N02BE_desk <- ts(pharma[,5], start = c(2016,1))
N02BE_3 = WMA(N02BE_desk, 3, 1:3)
N02BE_5 = WMA(N02BE_desk, 5, 1:5)
N02BE_7 = WMA(N02BE_desk, 7, 1:7)
N02BE_9 = WMA(N02BE_desk, 9, 1:9)
N02BE_11 = WMA(N02BE_desk, 11, 1:11)
N02BE_13 = WMA(N02BE_desk, 13, 1:13)
N02BE_15 = WMA(N02BE_desk, 15, 1:15)
pdf(file="C:/Users/Sophia/Documents/MO_Rozraha1/Rozrahunkova1/plots/Weighted/N02BE_WMA.pdf",
    width = 4,
    height = 4)
plot_N02BE <- plot(N02BE_desk, xlab = "Years, interval 3", ylab = "Sales volumes N02BE")
lines(N02BE_3, col="blue", lwd=3)
plot_N02BE <- plot(N02BE_desk, xlab = "Years, interval 5", ylab = "Sales volumes N02BE")
lines(N02BE_5, col="yellow", lwd=3)
plot_N02BE <- plot(N02BE_desk, xlab = "Years, interval 7", ylab = "Sales volumes N02BE")
lines(N02BE_7, col="green", lwd=3)
plot_N02BE9 <- plot(N02BE_desk, xlab = "Years, interval 9", ylab = "Sales volumes N02BE")
lines(N02BE_9, col="purple", lwd=3)
plot_N02BE11 <- plot(N02BE_desk, xlab = "Years, interval 11", ylab = "Sales volumes N02BE")
lines(N02BE_11, col="pink", lwd=3)
plot_N02BE13 <- plot(N02BE_desk, xlab = "Years, interval 13", ylab = "Sales volumes N02BE")
lines(N02BE_13, col="grey", lwd=3)
plot_N02BE15 <- plot(N02BE_desk, xlab = "Years, interval 15", ylab = "Sales volumes N02BE")
lines(N02BE_15, col="red", lwd=3)
abline(v=0)
text(x = 0, y = 1, labels="N02BE_wma")
dev.off()

#N05B
N05B_desk <- ts(pharma[,6], start = c(2016,1))
N05B_3 = WMA(N05B_desk, 3, 1:3)
N05B_5 = WMA(N05B_desk, 5, 1:5)
N05B_7 = WMA(N05B_desk, 7, 1:7)
N05B_9 = WMA(N05B_desk, 9, 1:9)
N05B_11 = WMA(N05B_desk, 11, 1:11)
N05B_13 = WMA(N05B_desk, 13, 1:13)
N05B_15 = WMA(N05B_desk, 15, 1:15)
pdf(file="C:/Users/Sophia/Documents/MO_Rozraha1/Rozrahunkova1/plots/Weighted/N05B_WMA.pdf",
    width = 4,
    height = 4)
plot_N05B <- plot(N05B_desk, xlab = "Years, interval 3", ylab = "Sales volumes N05B")
lines(N05B_3, col="blue", lwd=3)
plot_N05B <- plot(N05B_desk, xlab = "Years, interval 5", ylab = "Sales volumes N05B")
lines(N05B_5, col="yellow", lwd=3)
plot_N05B <- plot(N05B_desk, xlab = "Years, interval 7", ylab = "Sales volumes N05B")
lines(N05B_7, col="green", lwd=3)
plot_N05B9 <- plot(N05B_desk, xlab = "Years, interval 9", ylab = "Sales volumes N05B")
lines(N05B_9, col="purple", lwd=3)
plot_N05B11 <- plot(N05B_desk, xlab = "Years, interval 11", ylab = "Sales volumes N05B")
lines(N05B_11, col="pink", lwd=3)
plot_N05B13 <- plot(N05B_desk, xlab = "Years, interval 13", ylab = "Sales volumes N05B")
lines(N05B_13, col="grey", lwd=3)
plot_N05B15 <- plot(N05B_desk, xlab = "Years, interval 15", ylab = "Sales volumes N05B")
lines(N05B_15, col="red", lwd=3)
abline(v=0)
text(x = 0, y = 1, labels="N05B_wma")
dev.off()

#N05C
N05C_desk <- ts(pharma[,7], start = c(2016,1))
N05C_3 = WMA(N05C_desk, 3, 1:3)
N05C_5 = WMA(N05C_desk, 5, 1:5)
N05C_7 = WMA(N05C_desk, 7, 1:7)
N05C_9 = WMA(N05C_desk, 9, 1:9)
N05C_11 = WMA(N05C_desk, 11, 1:11)
N05C_13 = WMA(N05C_desk, 13, 1:13)
N05C_15 = WMA(N05C_desk, 15, 1:15)
pdf(file="C:/Users/Sophia/Documents/MO_Rozraha1/Rozrahunkova1/plots/Weighted/N05C_WMA.pdf",
    width = 4,
    height = 4)
plot_N05C <- plot(N05C_desk, xlab = "Years, interval 3", ylab = "Sales volumes N05C")
lines(N05C_3, col="blue", lwd=3)
plot_N05C <- plot(N05C_desk, xlab = "Years, interval 5", ylab = "Sales volumes N05C")
lines(N05C_5, col="yellow", lwd=3)
plot_N05C <- plot(N05C_desk, xlab = "Years, interval 7", ylab = "Sales volumes N05C")
lines(N05C_7, col="green", lwd=3)
plot_N05C9 <- plot(N05C_desk, xlab = "Years, interval 9", ylab = "Sales volumes N05C")
lines(N05C_9, col="purple", lwd=3)
plot_N05C11 <- plot(N05C_desk, xlab = "Years, interval 11", ylab = "Sales volumes N05C")
lines(N05C_11, col="pink", lwd=3)
plot_N05C13 <- plot(N05C_desk, xlab = "Years, interval 13", ylab = "Sales volumes N05C")
lines(N05C_13, col="grey", lwd=3)
plot_N05C15 <- plot(N05C_desk, xlab = "Years, interval 15", ylab = "Sales volumes N05C")
lines(N05C_15, col="red", lwd=3)
abline(v=0)
text(x = 0, y = 1, labels="N05C_wma")
dev.off()

#R03
R03_desk <- ts(pharma[,8], start = c(2016,1))
R03_3 = WMA(R03_desk, 3, 1:3)
R03_5 = WMA(R03_desk, 5, 1:5)
R03_7 = WMA(R03_desk, 7, 1:7)
R03_9 = WMA(R03_desk, 9, 1:9)
R03_11 = WMA(R03_desk, 11, 1:11)
R03_13 = WMA(R03_desk, 13, 1:13)
R03_15 = WMA(R03_desk, 15, 1:15)
pdf(file="C:/Users/Sophia/Documents/MO_Rozraha1/Rozrahunkova1/plots/Weighted/R03_WMA.pdf",
    width = 4,
    height = 4)
plot_R03 <- plot(R03_desk, xlab = "Years, interval 3", ylab = "Sales volumes R03")
lines(R03_3, col="blue", lwd=3)
plot_R03 <- plot(R03_desk, xlab = "Years, interval 5", ylab = "Sales volumes R03")
lines(R03_5, col="yellow", lwd=3)
plot_R03 <- plot(R03_desk, xlab = "Years, interval 7", ylab = "Sales volumes R03")
lines(R03_7, col="green", lwd=3)
plot_R039 <- plot(R03_desk, xlab = "Years, interval 9", ylab = "Sales volumes R03")
lines(R03_9, col="purple", lwd=3)
plot_R0311 <- plot(R03_desk, xlab = "Years, interval 11", ylab = "Sales volumes R03")
lines(R03_11, col="pink", lwd=3)
plot_R0313 <- plot(R03_desk, xlab = "Years, interval 13", ylab = "Sales volumes R03")
lines(R03_13, col="grey", lwd=3)
plot_R0315 <- plot(R03_desk, xlab = "Years, interval 15", ylab = "Sales volumes R03")
lines(R03_15, col="red", lwd=3)
abline(v=0)
text(x = 0, y = 1, labels="R03_wma")
dev.off()

#R06
R06_desk <- ts(pharma[,9], start = c(2016,1))
R06_3 = WMA(R06_desk, 3, 1:3)
R06_5 = WMA(R06_desk, 5, 1:5)
R06_7 = WMA(R06_desk, 7, 1:7)
R06_9 = WMA(R06_desk, 9, 1:9)
R06_11 = WMA(R06_desk, 11, 1:11)
R06_13 = WMA(R06_desk, 13, 1:13)
R06_15 = WMA(R06_desk, 15, 1:15)
pdf(file="C:/Users/Sophia/Documents/MO_Rozraha1/Rozrahunkova1/plots/Weighted/R06_WMA.pdf",
    width = 4,
    height = 4)
plot_R06 <- plot(R06_desk, xlab = "Years, interval 3", ylab = "Sales volumes R06")
lines(R06_3, col="blue", lwd=3)
plot_R06 <- plot(R06_desk, xlab = "Years, interval 5", ylab = "Sales volumes R06")
lines(R06_5, col="yellow", lwd=3)
plot_R06 <- plot(R06_desk, xlab = "Years, interval 7", ylab = "Sales volumes R06")
lines(R06_7, col="green", lwd=3)
plot_R069 <- plot(R06_desk, xlab = "Years, interval 9", ylab = "Sales volumes R06")
lines(R06_9, col="purple", lwd=3)
plot_R0611 <- plot(R06_desk, xlab = "Years, interval 11", ylab = "Sales volumes R06")
lines(R06_11, col="pink", lwd=3)
plot_R0613 <- plot(R06_desk, xlab = "Years, interval 13", ylab = "Sales volumes R06")
lines(R06_13, col="grey", lwd=3)
plot_R0615 <- plot(R06_desk, xlab = "Years, interval 15", ylab = "Sales volumes R06")
lines(R06_15, col="red", lwd=3)
abline(v=0)
text(x = 0, y = 1, labels="R06_wma")
dev.off()
